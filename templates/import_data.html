{% extends 'base.html' %}
{% block content %}
<h2 data-i18n="import_title">Import Data</h2>

<div class="row g-4">
  <!-- Import File Section -->
  <div class="col-12 col-lg-8">
    <div class="card p-4">
      <h5 data-i18n="import_file_title">📁 Import from File</h5>
      <p class="text-muted" data-i18n="import_file_desc">Upload Excel or CSV file with daily data to import previous records.</p>
      
      <form method="POST" enctype="multipart/form-data" class="mt-3">
        <div class="mb-3">
          <label for="file" class="form-label" data-i18n="select_file">Select File</label>
          <input type="file" class="form-control" id="file" name="file" accept=".xlsx,.xls,.csv" required>
          <div class="form-text" data-i18n="file_format_help">
            Supported formats: Excel (.xlsx, .xls) or CSV (.csv)
          </div>
        </div>
        
        <div class="alert alert-info">
          <h6 data-i18n="import_options">📋 Import Options:</h6>
          <div class="mb-3">
            <strong data-i18n="exported_files">🔄 Exported Files:</strong>
            <p class="mb-2" data-i18n="exported_desc">Upload files exported from this system to import complete data including daily records and medicines.</p>
          </div>
          
          <div class="mb-3">
            <strong data-i18n="custom_files">📊 Custom Files:</strong>
            <p class="mb-2" data-i18n="custom_desc">Upload Excel/CSV files with daily data only.</p>
          </div>
          
          <h6 data-i18n="required_columns">Required Columns for Custom Files:</h6>
          <ul class="mb-0">
            <li><strong>date</strong> - <span data-i18n="col_date_desc">Entry date (YYYY-MM-DD format)</span></li>
            <li><strong>mortality</strong> - <span data-i18n="col_mortality_desc">Number of dead birds</span></li>
            <li><strong>feed_bags_consumed</strong> - <span data-i18n="col_feed_consumed_desc">Feed bags used</span></li>
            <li><strong>feed_bags_added</strong> - <span data-i18n="col_feed_added_desc">Feed bags added</span></li>
            <li><strong>avg_weight</strong> - <span data-i18n="col_avg_weight_desc">Average weight in kg</span></li>
            <li><strong>fcr</strong> - <span data-i18n="col_fcr_desc">Feed conversion ratio</span></li>
            <li><strong>medicines</strong> - <span data-i18n="col_medicines_desc">Medicines given (optional)</span></li>
          </ul>
        </div>
        
        <button type="submit" class="btn btn-primary btn-lg" data-i18n="import_data_btn">
          📥 Import Data
        </button>
      </form>
    </div>
  </div>
  
  <!-- Quick Actions Section -->
  <div class="col-12 col-lg-4">
    <div class="card p-4">
      <h5 data-i18n="quick_actions">⚡ Quick Actions</h5>
      
      <div class="d-grid gap-3">
        <a href="{{ url_for('setup') }}" class="btn btn-success" data-i18n="new_cycle_btn">
          🐔 Start New Cycle
        </a>
        
        <a href="{{ url_for('export') }}" class="btn btn-outline-secondary" data-i18n="download_template">
          📋 Download Template
        </a>
        
        <form method="POST" action="{{ url_for('reset_cycle') }}" class="d-inline">
          <button type="submit" class="btn btn-warning w-100" 
                  onclick="return confirm('Are you sure you want to archive current cycle? / क्या आप वर्तमान चक्र को संग्रहीत करना चाहते हैं?')" 
                  data-i18n="archive_cycle_btn">
            📦 Archive Current Cycle
          </button>
        </form>
      </div>
      
      <div class="mt-4">
        <h6 data-i18n="import_tips">💡 Import Tips:</h6>
        <ul class="small text-muted">
          <li data-i18n="tip1">Make sure date format is YYYY-MM-DD</li>
          <li data-i18n="tip2">Numeric fields should contain only numbers</li>
          <li data-i18n="tip3">Existing entries for same date won't be duplicated</li>
          <li data-i18n="tip4">Empty cells will be treated as 0</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="mt-4">
      {% for category, message in messages %}
        <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

{% endblock %}
