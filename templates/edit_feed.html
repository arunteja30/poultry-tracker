{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
  <h2 class="mobile-header text-center mb-mobile-3">
    <span data-i18n="edit_feed">Edit Feed Record</span>
  </h2>

  <div class="card">
    <div class="card-header">
      <h5 data-i18n="edit_feed_details">Edit Feed Details</h5>
    </div>
    <div class="card-body">
      <form method="POST" action="{{ url_for('edit_feed', feed_id=feed.id) }}">
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="bill_number" class="form-label" data-i18n="bill_number">Bill Number</label>
            <input type="text" class="form-control" id="bill_number" name="bill_number" value="{{ feed.bill_number }}">
          </div>
          <div class="col-md-6 mb-3">
            <label for="date" class="form-label" data-i18n="date">Date *</label>
            <input type="date" class="form-control" id="date" name="date" value="{{ feed.date }}" required>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="feed_name" class="form-label" data-i18n="feed_name">Feed Name *</label>
            <input type="text" class="form-control" id="feed_name" name="feed_name" value="{{ feed.feed_name }}" required>
          </div>
          <div class="col-md-6 mb-3">
            <label for="feed_bags" class="form-label" data-i18n="number_of_bags">Number of Bags *</label>
            <input type="number" class="form-control" id="feed_bags" name="feed_bags" value="{{ feed.feed_bags }}" min="1" required>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="bag_weight" class="form-label" data-i18n="bag_weight">Bag Weight (kg)</label>
            <input type="number" step="0.1" class="form-control" id="bag_weight" name="bag_weight" value="{{ feed.bag_weight }}" min="0.1">
          </div>
          <div class="col-md-6 mb-3">
            <label for="price_per_kg" class="form-label" data-i18n="price_per_kg">Price per KG</label>
            <input type="number" step="0.01" class="form-control" id="price_per_kg" name="price_per_kg" value="{{ feed.price_per_kg }}" min="0">
          </div>
        </div>
        
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label" data-i18n="total_feed_kg">Total Feed (kg)</label>
            <input type="text" class="form-control" id="total_kg_display" readonly>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label" data-i18n="total_cost">Total Cost</label>
            <input type="text" class="form-control" id="total_cost_display" readonly>
          </div>
        </div>
        
        <div class="d-flex justify-content-between">
          <a href="{{ url_for('feed_management') }}" class="btn btn-secondary" data-i18n="cancel">Cancel</a>
          <button type="submit" class="btn btn-success" data-i18n="update">Update Feed Record</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// Calculate totals automatically
function updateTotals() {
  const bags = parseFloat(document.getElementById('feed_bags').value) || 0;
  const bagWeight = parseFloat(document.getElementById('bag_weight').value) || 50;
  const pricePerKg = parseFloat(document.getElementById('price_per_kg').value) || 0;
  
  const totalKg = bags * bagWeight;
  const totalCost = totalKg * pricePerKg;
  
  document.getElementById('total_kg_display').value = totalKg.toFixed(1) + ' kg';
  document.getElementById('total_cost_display').value = 'â‚¹' + totalCost.toFixed(2);
}

document.getElementById('feed_bags').addEventListener('input', updateTotals);
document.getElementById('bag_weight').addEventListener('input', updateTotals);
document.getElementById('price_per_kg').addEventListener('input', updateTotals);

// Initialize on page load
updateTotals();
</script>
{% endblock %}
