{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 data-i18n="edit_daily_title">‚úèÔ∏è Edit Daily Entry</h2>
  <a href="{{ url_for('daywise') }}" class="btn btn-secondary btn-sm" data-i18n="back_to_daily_reports">‚Üê Back to Daily Reports</a>
</div>

<!-- Entry Info -->
<div class="alert alert-info mb-4">
  <h6 data-i18n="editing_entry">üìÖ Editing Entry:</h6>
  <strong data-i18n="date">Date:</strong> {{ entry.entry_date }} | 
  <strong data-i18n="day">Day:</strong> {{ loop.index if loop else 'N/A' }} | 
  <strong data-i18n="cycle_id">Cycle ID:</strong> {{ cycle.id }}
</div>

<div class="card p-4">
  <form method="POST" class="row g-3">
    <div class="col-md-6">
      <label for="mortality" class="form-label" data-i18n="mortality">Mortality</label>
      <input id="mortality" type="number" name="mortality" class="form-control"
             value="{{ entry.mortality }}" min="0" required>
      <small class="text-muted" data-i18n="current">Current:</small> {{ entry.mortality }}
    </div>
    
    <div class="col-md-6">
      <label for="feed-consumed" class="form-label" data-i18n="feed_bags_consumed">Feed Bags Consumed</label>
      <input id="feed-consumed" type="number" step="0.1" name="feed_bags_consumed" class="form-control"
             value="{{ entry.feed_bags_consumed }}" min="0" required>
      <small class="text-muted" data-i18n="current">Current:</small> {{ entry.feed_bags_consumed }}
    </div>

    <div class="col-md-6">
      <label for="feed-added" class="form-label" data-i18n="feed_bags_added">Feed Bags Added</label>
      <input id="feed-added" type="number" step="0.1" name="feed_bags_added" class="form-control"
             value="{{ entry.feed_bags_added }}" min="0">
      <small class="text-muted" data-i18n="current">Current:</small> {{ entry.feed_bags_added }}
    </div>

    <div class="col-md-6">
      <label for="avg-weight" class="form-label" data-i18n="avg_weight">Avg Weight (kg)</label>
      <input id="avg-weight" type="number" step="0.001" name="avg_weight" class="form-control"
             value="{{ entry.avg_weight }}" min="0" required>
      <small class="text-muted" data-i18n="current">Current:</small> {{ entry.avg_weight }} kg ({{ (entry.avg_weight * 1000)|int }} g)</small>
    </div>

    <div class="col-12">
      <label for="medicines" class="form-label" data-i18n="medicines_given">Medicines Given</label>
      <textarea id="medicines" name="medicines" class="form-control" rows="3" 
                placeholder="Medicines given (if any)">{{ entry.medicines or 'None' }}</textarea>
      <small class="text-muted" data-i18n="current">Current:</small> {{ entry.medicines or 'None' }}
    </div>

    <div class="col-12">
      <label for="daily-notes" class="form-label" data-i18n="notes">Notes</label>
      <textarea id="daily-notes" name="daily_notes" class="form-control" rows="3" 
                placeholder="Notes (optional)">{{ entry.daily_notes or '' }}</textarea>
      <small class="text-muted" data-i18n="current">Current:</small> {{ entry.daily_notes or 'No notes' }}
    </div>

    <!-- Current calculated values display -->
    <div class="col-12">
      <div class="alert alert-secondary">
        <h6 data-i18n="current_calculated_values">Current Calculated Values:</h6>
        <div class="row">
          <div class="col-md-4">
            <strong data-i18n="fcr">FCR:</strong> {{ entry.fcr }}
          </div>
          <div class="col-md-4">
            <strong data-i18n="avg_feed_per_bird">Avg Feed/Bird:</strong> {{ "{:,.1f}".format(entry.avg_feed_per_bird_g) }}g
          </div>
          <div class="col-md-4">
            <strong data-i18n="birds_at_time">Birds at time:</strong> {{ entry.birds_survived if entry.birds_survived else ('na'|translate) }}
          </div>
        </div>
      </div>
    </div>

    <!-- Action buttons -->
    <div class="col-12">
      <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <a href="{{ url_for('daywise') }}" class="btn btn-secondary me-md-2" data-i18n="cancel">Cancel</a>
        <button type="submit" class="btn btn-primary">
          <span data-i18n="update_entry">‚úèÔ∏è Update Entry</span>
        </button>
      </div>
    </div>
  </form>
</div>

<!-- Warning Note -->
<div class="alert alert-warning mt-4">
  <h6 data-i18n="important_notes">‚ö†Ô∏è Important Notes:</h6>
  <ul class="mb-0">
    <li data-i18n="note_cycle_totals">Changing values will affect cycle totals and calculations</li>
    <li data-i18n="note_fcr_recalc">FCR and Avg Feed/Bird will be recalculated automatically</li>
    <li data-i18n="note_bird_count">Bird count changes will affect current cycle bird count</li>
    <li data-i18n="note_feed_inventory">Feed bag changes will affect available feed inventory</li>
  </ul>
</div>

{% endblock %}
