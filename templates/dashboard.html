{% extends 'base.html' %}
{% block content %}
<h2 data-i18n="dashboard_title">Dashboard</h2>
<div class="row g-3">
  <div class="col-12 col-md-6">
    <div class="card p-3">
      <h5 data-i18n="summary">Summary</h5>
      {% if cycle %}
        <p><strong data-i18n="live_birds">Live Birds:</strong> {{ summary.current_birds }}</p>
        <p><strong data-i18n="day_of_farm">Days of Farm:</strong> {{ summary.days }}</p>
        <p><strong data-i18n="bags_available">Bags Available:</strong> {{ summary.bags_available }}</p>
        <p><strong data-i18n="bags_consumed_total">Bags Consumed (Total):</strong> {{ summary.feed_bags_consumed_total }}</p>
        <p><strong data-i18n="mortality_total">Mortality (Total):</strong> {{ summary.mortality_total }}</p>
        <p><strong data-i18n="fcr_today">FCR Today:</strong> {{ summary.fcr_today if summary.fcr_today else '-' }}</p>
      {% else %}
        <p data-i18n="no_cycle">No active cycle. Please setup.</p>
      {% endif %}
    </div>
  </div>
  <div class="col-12 col-md-6">
    <div class="card p-3">
      <h5 data-i18n="graphs">Graphs</h5>
      <canvas id="fcrChart"></canvas>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
const fcrSeries = {{ fcr_series|tojson }};
const dates = {{ dates|tojson }};
const ctx = document.getElementById('fcrChart').getContext('2d');
new Chart(ctx,{
  type:'line',
  data:{
    labels: dates,
    datasets:[{label:'FCR', data:fcrSeries, tension:0.2, borderWidth:2}]
  },
  options:{scales:{y:{beginAtZero:true}}}
});
</script>
{% endblock %}
